apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "config.openshift.io/v1",
          "kind": "DataProcessingUnit",
          "metadata": {
            "name": "dataprocessingunit-sample"
          },
          "spec": {
            "nodeName": "worker-node-1",
            "dpuProductName": "BlueField-2",
            "isDpuSide": false,
            "pciAddress": "0000:03:00.0"
          }
        },
        {
          "apiVersion": "config.openshift.io/v1",
          "kind": "DataProcessingUnitConfig",
          "metadata": {
            "name": "dataprocessingunitconfig-sample"
          },
          "spec": {
            "dpuSelector": {
              "matchLabels": {
                "vendor": "nvidia"
              }
            },
            "nodeSelector": {
              "matchLabels": {
                "dpu-enabled": "true"
              }
            }
          }
        },
        {
          "apiVersion": "config.openshift.io/v1",
          "kind": "DpuOperatorConfig",
          "metadata": {
            "name": "dpuoperatorconfig-sample"
          },
          "spec": {
            "logLevel": 2
          }
        },
        {
          "apiVersion": "config.openshift.io/v1",
          "kind": "ServiceFunctionChain",
          "metadata": {
            "name": "servicefunctionchain-sample"
          },
          "spec": {
            "networkFunctions": [
              {
                "name": "firewall",
                "image": "example.com/firewall:latest"
              },
              {
                "name": "load-balancer",
                "image": "example.com/lb:latest"
              }
            ],
            "nodeSelector": {
              "dpu": "true"
            }
          }
        }
      ]
    capabilities: Seamless Upgrades
    categories: "Networking,Storage,Security"
    certified: "false"
    containerImage: quay.io/openshift/dpu-operator:v1.0.0
    createdAt: "2026-02-01T00:00:00Z"
    description: Vendor-agnostic Kubernetes operator for managing DPU/IPU devices with unified OPI-based plugin architecture
    features.operators.openshift.io/cnf: "true"
    features.operators.openshift.io/cni: "true"
    features.operators.openshift.io/csi: "false"
    features.operators.openshift.io/disconnected: "true"
    features.operators.openshift.io/fips-compliant: "true"
    features.operators.openshift.io/proxy-aware: "false"
    features.operators.openshift.io/tls-profiles: "false"
    features.operators.openshift.io/token-auth-aws: "false"
    features.operators.openshift.io/token-auth-azure: "false"
    features.operators.openshift.io/token-auth-gcp: "false"
    operatorframework.io/suggested-namespace: openshift-dpu-operator
    operators.operatorframework.io/builder: operator-sdk-v1.41.0
    operators.operatorframework.io/project_layout: go.kubebuilder.io/v4
    repository: https://github.com/openshift/dpu-operator
    support: Red Hat
  name: dpu-operator.v1.0.0
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - description: DataProcessingUnit represents a discovered DPU device in the cluster
      displayName: Data Processing Unit
      kind: DataProcessingUnit
      name: dataprocessingunits.config.openshift.io
      version: v1
      specDescriptors:
      - description: Name of the node where this DPU is located
        displayName: Node Name
        path: nodeName
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes:Node
      - description: Product name of the DPU (e.g., BlueField-2, IPU E2100)
        displayName: DPU Product Name
        path: dpuProductName
      - description: Whether this CR represents the DPU-side view
        displayName: Is DPU Side
        path: isDpuSide
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:booleanSwitch
      - description: PCI address of the DPU device
        displayName: PCI Address
        path: pciAddress
      statusDescriptors:
      - description: Current status conditions of the DPU
        displayName: Conditions
        path: conditions
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.conditions
    - description: DataProcessingUnitConfig configures how DPUs are managed in the cluster
      displayName: Data Processing Unit Config
      kind: DataProcessingUnitConfig
      name: dataprocessingunitconfigs.config.openshift.io
      version: v1
      specDescriptors:
      - description: Selector for DPUs to configure
        displayName: DPU Selector
        path: dpuSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:selector
      - description: Selector for nodes with DPUs
        displayName: Node Selector
        path: nodeSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:selector
      statusDescriptors:
      - description: Current status conditions
        displayName: Conditions
        path: conditions
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.conditions
    - description: DpuOperatorConfig configures global operator behavior
      displayName: DPU Operator Config
      kind: DpuOperatorConfig
      name: dpuoperatorconfigs.config.openshift.io
      version: v1
      specDescriptors:
      - description: Logging verbosity level (0-4)
        displayName: Log Level
        path: logLevel
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:number
      statusDescriptors:
      - description: Current status conditions
        displayName: Conditions
        path: conditions
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.conditions
    - description: ServiceFunctionChain defines a chain of network functions to run on DPUs
      displayName: Service Function Chain
      kind: ServiceFunctionChain
      name: servicefunctionchains.config.openshift.io
      version: v1
      specDescriptors:
      - description: List of network functions in the chain
        displayName: Network Functions
        path: networkFunctions
      - description: Node selector for placing the chain
        displayName: Node Selector
        path: nodeSelector
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:selector
      statusDescriptors:
      - description: Current status conditions
        displayName: Conditions
        path: conditions
        x-descriptors:
        - urn:alm:descriptor:io.kubernetes.conditions
  description: |
    # DPU Operator

    The DPU Operator provides a vendor-agnostic way to manage Data Processing Units (DPUs) and Infrastructure Processing Units (IPUs) in Kubernetes clusters. It supports multiple hardware vendors through a unified plugin architecture based on the Open Programmable Infrastructure (OPI) standards.

    ## Supported Hardware

    - **NVIDIA**: BlueField-2, BlueField-3 DPUs
    - **Intel**: IPU E2100, NetSec IPU
    - **Marvell**: Octeon DPUs
    - **MangoBoost**: XSight-based DPUs

    ## Key Features

    ### Multi-Vendor Support
    Unified management interface for DPUs from different vendors, allowing you to run heterogeneous DPU deployments with consistent APIs.

    ### OPI-Based Architecture
    Built on Open Programmable Infrastructure standards for vendor-neutral device management and offload operations.

    ### Hardware Offload Capabilities
    - **Networking**: VF management, bridge ports, EVPN gateway, network functions
    - **Storage**: NVMe-oF target offload, namespace management
    - **Security**: IPsec tunnel offload, encryption acceleration
    - **AI/ML**: Inference acceleration (vendor-specific)

    ### Service Function Chaining
    Deploy and manage chains of network functions (firewalls, load balancers, IDS/IPS) running on DPU hardware.

    ### Automated Discovery
    Automatic detection and registration of DPU devices via PCI scanning and vendor plugins.

    ### Lifecycle Management
    Complete lifecycle management including device provisioning, configuration, firmware updates, and health monitoring.

    ## Prerequisites

    - Kubernetes 1.24+
    - OpenShift 4.11+ (for OpenShift deployments)
    - DPU hardware from supported vendors
    - Appropriate vendor-specific OPI bridges installed on DPU devices

    ## Getting Started

    1. Install the DPU Operator from OperatorHub
    2. Create a DpuOperatorConfig to configure global settings
    3. DPUs will be automatically discovered and DataProcessingUnit resources created
    4. Use DataProcessingUnitConfig to configure discovered DPUs
    5. Deploy ServiceFunctionChains to run network functions on DPUs

    ## Example: Deploying a Service Function Chain

    ```yaml
    apiVersion: config.openshift.io/v1
    kind: ServiceFunctionChain
    metadata:
      name: edge-security
    spec:
      networkFunctions:
      - name: firewall
        image: quay.io/example/nf-firewall:latest
      - name: ids
        image: quay.io/example/nf-ids:latest
      nodeSelector:
        dpu-vendor: nvidia
        dpu-enabled: "true"
    ```

    ## Documentation

    For detailed documentation, visit: https://github.com/openshift/dpu-operator/tree/main/docs

    ## Support

    This operator is supported by Red Hat. For issues and questions:
    - GitHub Issues: https://github.com/openshift/dpu-operator/issues
    - Red Hat Support: https://access.redhat.com/support

  displayName: DPU Operator
  icon:
  - base64data: iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFxmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNy4xLWMwMDAgNzkuZWRhMmIzZmFjLCAyMDIxLzExLzE3LTE3OjIzOjE5ICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+Cjw/eHBhY2tldCBlbmQ9InIiPz4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCg==
    mediatype: image/png
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - '*'
          - serviceaccounts
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims
          - persistentvolumes
          - pods
          - secrets
          - services
          verbs:
          - '*'
        - apiGroups:
          - admissionregistration.k8s.io
          resources:
          - mutatingwebhookconfigurations
          verbs:
          - '*'
        - apiGroups:
          - apiextensions.k8s.io
          resources:
          - customresourcedefinitions
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - apps
          resources:
          - daemonsets
          - deployments
          - replicasets
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - config.openshift.io
          resources:
          - dataprocessingunitconfigs
          - dataprocessingunits
          - dpuoperatorconfigs
          - servicefunctionchains
          - servicefunctionchains/finalizers
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - config.openshift.io
          resources:
          - dataprocessingunitconfigs/finalizers
          - dataprocessingunits/finalizers
          - dpuoperatorconfigs/finalizers
          verbs:
          - update
        - apiGroups:
          - config.openshift.io
          resources:
          - dataprocessingunitconfigs/status
          - dataprocessingunits/status
          - dpuoperatorconfigs/status
          - servicefunctionchains/status
          verbs:
          - get
          - patch
          - update
        - apiGroups:
          - k8s.cni.cncf.io
          resources:
          - network-attachment-definitions
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - rbac.authorization.k8s.io
          resources:
          - clusterrolebindings
          - clusterroles
          - rolebindings
          - roles
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - security.openshift.io
          resourceNames:
          - anyuid
          - hostnetwork
          - privileged
          resources:
          - securitycontextconstraints
          verbs:
          - use
        serviceAccountName: controller-manager
      deployments:
      - label:
          control-plane: controller-manager
        name: dpu-operator-controller-manager
        spec:
          replicas: 1
          selector:
            matchLabels:
              control-plane: controller-manager
          strategy: {}
          template:
            metadata:
              annotations:
                kubectl.kubernetes.io/default-container: manager
              labels:
                control-plane: controller-manager
            spec:
              containers:
              - args:
                - --health-probe-bind-address=:8081
                - --metrics-bind-address=:10443
                - --leader-elect
                command:
                - /manager
                env:
                - name: DpuOperatorDaemonImage
                  value: quay.io/openshift/dpu-daemon:v1.0.0
                - name: NRIWebhookImage
                  value: quay.io/openshift/dpu-network-resources-injector:v1.0.0
                - name: intel_ipu
                  value: quay.io/openshift/dpu-intel-ipu-vsp:v1.0.0
                - name: IntelVspP4Image
                  value: quay.io/openshift/dpu-intel-ipu-p4sdk:v1.0.0
                - name: marvell_dpu
                  value: quay.io/openshift/dpu-marvell-vsp:v1.0.0
                - name: MarvellVspCpAgentImage
                  value: quay.io/openshift/dpu-marvell-cp-agent:v1.0.0
                - name: intel_netsec
                  value: quay.io/openshift/dpu-intel-netsec-vsp:v1.0.0
                - name: nvidia_bf
                  value: quay.io/openshift/dpu-nvidia-bf-vsp:v1.0.0
                - name: xsight
                  value: quay.io/openshift/dpu-xsight-vsp:v1.0.0
                - name: mangoboost
                  value: quay.io/openshift/dpu-mangoboost-vsp:v1.0.0
                image: quay.io/openshift/dpu-operator:v1.0.0
                livenessProbe:
                  httpGet:
                    path: /healthz
                    port: 8081
                  initialDelaySeconds: 15
                  periodSeconds: 20
                name: manager
                ports:
                - containerPort: 10443
                  name: metrics-server
                  protocol: TCP
                readinessProbe:
                  httpGet:
                    path: /readyz
                    port: 8081
                  initialDelaySeconds: 5
                  periodSeconds: 10
                resources:
                  limits:
                    cpu: 500m
                    memory: 256Mi
                  requests:
                    cpu: 10m
                    memory: 64Mi
                securityContext:
                  allowPrivilegeEscalation: false
                  capabilities:
                    drop:
                    - ALL
                volumeMounts:
                - mountPath: /host-run
                  name: host-run
                  readOnly: true
              securityContext:
                runAsNonRoot: true
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: controller-manager
              terminationGracePeriodSeconds: 10
              volumes:
              - hostPath:
                  path: /run
                  type: DirectoryOrCreate
                name: host-run
      permissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
        serviceAccountName: controller-manager
    strategy: deployment
  installModes:
  - supported: false
    type: OwnNamespace
  - supported: false
    type: SingleNamespace
  - supported: false
    type: MultiNamespace
  - supported: true
    type: AllNamespaces
  keywords:
  - dpu
  - ipu
  - networking
  - storage
  - offload
  - nvidia
  - intel
  - marvell
  - bluefield
  - opi
  - smartnic
  links:
  - name: DPU Operator
    url: https://github.com/openshift/dpu-operator
  - name: Documentation
    url: https://github.com/openshift/dpu-operator/tree/main/docs
  - name: OPI Project
    url: https://opiproject.org
  maintainers:
  - email: dpu-operator@redhat.com
    name: Red Hat DPU Team
  maturity: stable
  minKubeVersion: 1.24.0
  provider:
    name: Red Hat
    url: https://www.redhat.com
  version: 1.0.0
  webhookdefinitions:
  - admissionReviewVersions:
    - v1
    containerPort: 443
    deploymentName: dpu-operator-controller-manager
    failurePolicy: Fail
    generateName: vdpuoperatorconfig.kb.io
    rules:
    - apiGroups:
      - config.openshift.io
      apiVersions:
      - v1
      operations:
      - CREATE
      - UPDATE
      resources:
      - dpuoperatorconfigs
    sideEffects: None
    targetPort: 9443
    type: ValidatingAdmissionWebhook
    webhookPath: /validate-config-openshift-io-v1-dpuoperatorconfig
